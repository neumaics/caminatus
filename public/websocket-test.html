<!DOCTYPE html>
<meta charset="utf-8" />
<title>WebSocket Test</title>
<!--provided by https://www.websocket.org/echo.html -->
<script language="javascript" type="text/javascript">
const wsUri = "wss://echo.websocket.org/";
let output;

const onOpen = (evt) => {
  writeToScreen("CONNECTED");
  doSend("WebSocket rocks");
}

const onClose = (evt) => {
  writeToScreen("DISCONNECTED");
}

const onMessage = (evt) => {
  writeToScreen('<span style="color: blue;">RESPONSE: ' + evt.data+'</span>');
  websocket.close();
}

const onError = (evt) => {
  writeToScreen('<span style="color: red;">ERROR:</span> ' + evt.data);
}

const doSend = (message) => {
  writeToScreen("SENT: " + message);
  websocket.send(message);
}

const writeToScreen = (message) => {
  const pre = document.createElement("p");
  pre.style.wordWrap = "break-word";
  pre.innerHTML = message;
  output.appendChild(pre);
}

const testWebSocket = () => {
  websocket = new WebSocket(wsUri);
  websocket.onopen = onOpen;
  websocket.onclose = onClose;
  websocket.onmessage = onMessage;
  websocket.onerror = onError;
}

const init = () => {
  output = document.getElementById("output");
  testWebSocket();
}


window.addEventListener("load", init, false);

</script>

<h2>WebSocket Test</h2>

<div id="output"></div>